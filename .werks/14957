Title: fileinfo: Crash on negative timespans
Class: fix
Compatible: compat
Component: checks
Date: 1667220707
Edition: cre
Knowledge: doc
Level: 1
State: unknown
Version: 2.1.0p16

Services relating to size and age of files and filegroups
(i.e., all services basing on the <i>fileinfo</i> agent section) may fail
temporarily with a crash report containing the error "Cannot render negative
timespan".

There is a small chance that a monitored file is touched at the instant
right after the agent started calculating the fileinfo section, and before the
timestamp of the file is evaluated.
If the UNIX timestamp additionally steps over a full second, this would lead
to a negative age of the file, because the fileinfo plugin determines the
file age relative to a reference timestamp that's taken on plugin start.

This situation is now fixed by taking the reference timestamp as last step.
