Title: CSRF token leaked in URL parameters (CVE-2024-38863)
Class: security
Compatible: compat
Component: wato
Date: 1728280120
Edition: cre
Level: 1
Version: 2.1.0p48

Before this Werk, the CSRF token was mistakenly included as a query parameter in certain URLs when navigating Checkmk, which could result in the token being saved in bookmarks.
This increased the risk of unintentional exposure, such as when sharing bookmarks with other users.
The issue has been resolved.

While storing or unintentionally exposing the token doesn't present an immediate security threat, it could potentially enable phishing attacks targeting the specific user for the duration of the token's validity.
In Checkmk, CSRF tokens remain valid for the session's duration (configured under Global settings > Session management).

This issue was found during internal review.

<em>Affected Versions</em>:

LI: 2.3.0
LI: 2.2.0
LI: 2.1.0

<em>Mitigations</em>:

Avoid sharing or exposing URLs that contain the query parameter <code>csrf_token=</code>.

<em>Vulnerability Management</em>:

We have rated the issue with a CVSS Score of 2.0 Low (<code>CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:A/VC:L/VI:N/VA:N/SC:L/SI:L/SA:L</code>) and assigned <code>CVE-2024-38863</code>.
