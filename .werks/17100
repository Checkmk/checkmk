Title: Fix use of empty session secret
Class: security
Compatible: compat
Component: wato
Date: 1746713406
Edition: cre
Level: 1
Version: 2.2.0p42

Previously, Checkmk sites created with version 2.2.0 and later were initialized with an empty session secret (<code>etc/auth.secret</code>) and Checkmk would use empty secrets to sign session cookies.
As a consequence, obtaining a users active session ID would be sufficient for an attacker in order to take over that session.

With this Werk Checkmk will no longer allow empty secrets.
Existing empty secrets will be replaced.
Note that this will cause all current session cookies to be invalidated.

We are not aware of any way to leak session IDs and thus exploit this issue.
Therefore, we do not assign a CVE and we assign CVSS score of 0.0 None (<code>CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:N/SI:N/SA:N</code>).
