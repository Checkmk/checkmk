Title: Fix secrets added to URL query params
Class: security
Compatible: compat
Component: wato
Date: 1754573399
Edition: cre
Level: 1
Version: 2.2.0p46

Previously, under specific conditions (toggling page navigation after receiving validation errors when submitting a form), passwords and other secrets entered in the form could be exposed in URL query parameters.
Importantly, this did not affect any stored secrets; only the data just entered by the user was at risk.
This could result in sensitive data being leaked, for example, to server logs.

Such sensitive information is now excluded from the URL query parameters.

This issue was reported to us by an external party.

<em>Affected Versions</em>:

LI: 2.4.0
LI: 2.3.0
LI: 2.2.0
LI: 2.1.0 (EOL)

<em>Vulnerability Management</em>:

We have rated the issue with a CVSS Score of 1.0 Low (<code>CVSS:4.0/AV:L/AC:L/AT:P/PR:H/UI:P/VC:L/VI:N/VA:N/SC:L/SI:N/SA:N</code>) and assigned <code>CVE-2025-32916</code>.
