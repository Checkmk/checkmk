[//]: # (werk v2)
# cmk-migrate-http: Handle virtual host without host correctly

key        | value
---------- | ---
date       | 2025-10-09T08:30:25+00:00
version    | 2.5.0b1
class      | fix
edition    | cre
component  | omd
level      | 1
compatible | yes

The script `cmk-migrate-http` can be used to migrate `check_http` rules to `check_httpv2` rules in an automated fashion.

The old plug-in `check_http` supported HTTP/1.0, which is no longer supported by the new plug-in.
Because of this, `cmk-migrate-http` uses the `Virtual host` field to obtain a host name to construct a url.
However, this did not take into account that in some configurations the `Virtual host` field may contain invalid values (with respect to RFC7230).
For example, the value `/web` would result in the url `http:///web`.

With this Werk, the invalid `Virtual host` field will be ignored.
The migration will fallback to the `Address` field.
The `Virtual host` field is still used for the Host header.
In effect, this means that `check_httpv2` will send the same request as `check_http` did.

Note, that a RFC7230 compliant server should reject these types of requests with a 404.
