Title: Fix security vulnerability in win_license.bat plugin
Class: security
Compatible: compat
Component: agents
Date: 1755785721
Edition: cee
Level: 1
Version: 2.2.0p46

On Windows hosts to force the English output from the <code>win_license.bat</code> plugin,
special copying logic is used (this way, the default <code>slmgr.vbs</code> script cannot find the language files).
As the script is copied to a global, unprotected location, every user has access to edit this script.
This can be exploited for malicious intent.
To eliminate this vulnerability, the <code>slmgr.vbs</code> script is copied to the protected location 
in <code>%SystemDrive%\ProgramData\checkmk\agent\tmp</code> and is deleted afterwards.

<strong>Note:</strong> Only users who use the Windows License plug-in are affected by this issue.

We thank Lisa Gnedt (SBA Research) for reporting this issue.

<em>Affected Versions</em>:

LI: 2.4.0
LI: 2.3.0
LI: 2.2.0
LI: 2.1.0 (EOL)

<em>Mitigations</em>:

If you cannot update, disable the Windows License plug-in.

<em>Vulnerability Management</em>:

We have rated the issue with a CVSS Score of 8.8 High (<code>CVSS:4.0/AV:L/AC:L/AT:P/PR:L/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H</code>) and assigned <code>CVE-2025-32919</code>.
