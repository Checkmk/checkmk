[//]: # (werk v2)
# messaging: correctly start RabbitMQ in case of ipv6 disabled

key        | value
---------- | ---
date       | 2025-07-30T13:38:54+00:00
version    | 2.5.0b1
class      | fix
edition    | cre
component  | packages
level      | 1
compatible | yes

On systems with IPv6 disabled, RabbitMQ was not starting, with an error in the logs similar to this one:

    Failed to start Ranch listener {acceptor,{0,0,0,0,0,0,0,1},15672} in
    ranch_tcp:listen(#{socket_opts => [{cacerts,'...'},{key,'...'},{cert,'...'},
    {ip,{0,0,0,0,0,0,0,1}},{port,15672}]}) for reason eaddrnotavail (can't assign requested address)

From this werk, the management listener IP (localhost) is computed during RabbitMQ restart:
'::1' if IPv6 is enabled, '127.0.0.1' if IPv6 is disabled.
The default IP list from which RabbitMQ accepts connections (via the AMQP protocol) is also expanded:
it was only '::' and now includes '0.0.0.0', ensuring the listeners are running even when IPv6 is disabled.

Please be aware that, if ipv6 is disabled while checkmk is running,
a manual restart of rabbitmq will be required, via the command `omd restart rabbitmq`.