[//]: # (werk v2)
# MS Office checks: Microsoft Graph PowerShell module must be installed manually

key        | value
---------- | ---
date       | 2025-10-16T13:21:08+00:00
version    | 2.4.0p14
class      | fix
edition    | cee
component  | agents
level      | 1
compatible | no

The MS Office agent plugin no longer installs the Microsoft Graph PowerShell module automatically.

Previously, the MS Office agent plugin (`mk_msoffice.ps1`) would automatically install the Microsoft Graph PowerShell module if it was not present on the system.

This automatic installation has been removed to improve security and reduce the plugin's complexity.

The plugin now checks for the presence of the Microsoft Graph module and will output error messages for both `msoffice_licenses` and `msoffice_serviceplans` checks if the module is not installed.

**Impact on existing users:**

- Existing MS Office monitoring will continue to work if the Microsoft Graph module is already installed
- No immediate action is required for systems that already have the module installed

**Manual intervention required for new deployments:**

For new installations or systems without the Microsoft Graph PowerShell module, administrators must manually install it before using the MS Office checks:

```powershell
Install-Module Microsoft.Graph -Scope AllUsers -Repository PSGallery -Force
```

For detailed installation instructions, see: https://learn.microsoft.com/en-us/powershell/microsoftgraph/installation?view=graph-powershell-1.0

If the module is not installed, the checks will display the error message: "MS Office agent plugin requires installation of the Powershell Module Microsoft.Graph for all users"

**Benefits:**

- Enhanced security by removing automatic software installation
- Improved plugin reliability and predictability
- Reduced plugin complexity and potential permission issues

This change affects all new users setting up Microsoft 365 licenses and service plans monitoring through Checkmk.
