[//]: # (werk v2)
# netapp_ontap: handle snapmirrors with no policy

key        | value
---------- | ---
date       | 2025-09-23T12:06:58+00:00
version    | 2.3.0p39
class      | fix
edition    | cre
component  | checks
level      | 1
compatible | yes

The netapp_ontap special agent crashed with:

    File "/omd/sites/site_name/lib/python3/cmk/special_agents/agent_netapp_ontap.py", line 808, in fetch_snapmirror
        policy_name=element_data["policy"]["name"],
    'policy'

That was because some NetApp ONTAP API versions were reporting Snapmirrors with no policy.

The netapp check and special agent have been updated to handle this case,
and will now display "Policy not set" in the service summary of Snapmirrors without a policy reported.
