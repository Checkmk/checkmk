[//]: # (werk v2)
# Check HTTP web service: Fix and improve text searches

key        | value
---------- | ---
date       | 2025-12-08T13:35:51+00:00
version    | 2.4.0p18
class      | fix
edition    | cre
component  | checks
level      | 1
compatible | no

This Werk contains the fixes as applied to Checkmk 2.3 with Werk #18920, but goes beyond that and improves the configuration and output of the _Search for strings_ option.

**Inverted header regex search didn't work**
Like in Werk #18920, the inverted header regex search is fixed now.

**New info text**
Instead of _(matched)_/_(not matched)_, the check output of regex searches now reads _(match found)/(no match found)_.<br>
This little difference better matches the expression about _what_ is matched/not matched (The regex? Or the condition?)<br>
And yes, like in Werk #18920, the output now is correct, with the following possibilities:

* _OK_ Expected ... (match found)
* _CRIT_ Expected  (no match found)
* _OK_ Not expected ... (no match found)
* _CRIT_ Not expected ... (match found)

**Default CRIT state**
Yes, we deliberately wrote _CRIT_ in the section above.<br>
Since the initial release of the new _Check HTTP web service_ (`check_httpv2`) active check, we received some feedback regarding the (in)compatibility to the legacy _Check HTTP service_ (`check_http`) active check in some parts.<br>
One common issue was `check_http` returning _CRIT_ in case of failed string searches, while `check_httpv2` returns _WARN_.<br>
Based on this feedback we now change the state to _CRIT_ to make `check_httpv2` more suitable as a drop-in-replacement for the legacy `check_http`.<br>
Please note that this is considered an incompatible change, as it happens on patch release upgrade.<br>
You did like the _WARN_ state? Then the next item is for you.

**Configurable state**
We think that a returned _WARN_ state better resembles the general Checkmk behavior in case of a failing string search. A _CRIT_ state rather expresses a degraded system, like unreachable recources, or an exceeded limit indicating that some failure is imminent.<br>
Because of this, we decided to make the state for failing _Search for strings_ conditions configurable. As mentioned above, it defaults to _CRIT_, but is now configurable via the additional _Service state for failing text search condition_ entry.

