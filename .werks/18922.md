[//]: # (werk v2)
# Check HTTP web service: Fix text searches

key        | value
---------- | ---
date       | 2025-12-08T08:48:50+00:00
version    | 2.3.0p42
class      | fix
edition    | cre
component  | checks
level      | 1
compatible | yes

In the _Check HTTP web service_ ruleset, when configuring<br>
_Search for strings > search for header > Regular expression > Return CRITICAL_ [sic] _if found, OK if not_<br>,
some bugs occured:

**Wrong caption in ruleset**<br>
First of all: The caption should read _Return WARN if found, OK if not_, since _WARN_ is the fixed state that will be returned for all failing header/body string/regex searches.<br>
Please note that this will change starting with Checkmk 2.4.0p18, see Werk #18921.

**Inverted header regex search didn't work**<br>
The service yielded an _OK_ state most of the times, even if the regex _was_ found in the headers.<br>
This happened because the search iterates over all headers and stopped on first expected result. If the first header didn't contain the regex, the engine was satisfied and didn't continue.

**Wrong info on inverted header regex searches**<br>
Also the appended _(matched)/(not matched)_ info was swapped, leading to even more confusion.<br>
Note: This info text will be enhanced a bit to be more meaningful, see also Werk #18921.
