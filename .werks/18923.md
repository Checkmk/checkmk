[//]: # (werk v2)
# Agent bakery .deb packages: Don't clean up /var/lib/check_mk_agent

key        | value
---------- | ---
date       | 2025-12-10T08:57:49+00:00
version    | 2.5.0b1
class      | fix
edition    | cee
component  | checks
level      | 1
compatible | no

Agent bakery dpkg (`.deb`) packages for Linux previously removed the directory `/var/lib/check_mk_agent` on uninstallation.

With this Werk, we stop removing this directory explicitly.

Notes:

* Only bakery dpkg packages deleted this directory. All other packages, including the prepackaged dpkg package that comes with the Checkmk installation, left it behind.
* This only ever affected the default `/var/lib/check_mk_agent` directory. If the _var_ directory was configured to some non-standard path with the _Installation paths for agent files (Linux, UNIX) (deprecated)_ ruleset, it never was deleted explicitly on uninstallation.
* It is common and expected behavior of dpkg packages to leave variable data behind. More precisely: If a directory is pre-existing before installation and a dpkg package would create it, it won't be deleted on uninstallation. If the dpkg package happens to create a directory, it will only remove it on uninstallation if all files and directories underneath already came with the package. Based on these rules, the `/var/lib/check_mk_agent` directory is usually left behind on dpkg uninstallation.

If you currently rely on the automatic removal of the package's variable data, please update your workflow or scripts.
