[//]: # (werk v2)
# Fix schedule downtime error in "All aggregations" view

key        | value
---------- | ---
date       | 2026-01-19T08:02:22+00:00
version    | 2.6.0b1
class      | fix
edition    | cre
component  | bi
level      | 2
compatible | yes

At some point during the development of the 2.3 release, the schedule downtime
command in the Business Intelligence component became broken. Triggering a
downtime would raise a `KeyError`, stating that the `host_name` key was not
found.

This key is indeed the correct key for the "Hosts" and "Services" views, but not
for the "All aggregations" view in BI. For this view, the host values need to be
extracted from the `aggr_hosts` key.

The applied fix now detects the source of the schedule downtime request and uses
the appropriate key accordingly. After upgrading to the next patch release,
scheduling downtime works correctly in the "All aggregations" view without any
further user intervention.

**Note:** you may notice in the confirmation dialog that it refers to "Hosts"
and not "Aggregations". This is a known bug which we will investigate in a
follow-up task. The goal of this change is to simply get the schedule downtime
command working again from the "All aggregations" view.
