title: Length of MS Exchange queues
agents: windows
catalog: app/exchange
license: GPL
distribution: check_mk
description:
 This check monitors the current length of various MS Exchange
 mail queues. You need a Windows agent of version {1.1.11i1} or
 later and have the counter object {msx_queues} activated.
 This counter is activated per default with the number {10332}.

 If the counter number is different in your installation or
 you are using a {check_mk.ini} with custom counter definitions,
 add the counter to the section {[winperf]} with {counters = 10332:msx_queues} ... .
 Look in the output of {lodctr /s:counters.ini} for the object with
 the name {MSExchangeTransport Queues}.

 You can set levels for warning and critical. Per default
 the queues {Active Remote Delivery}, {Active Mailbox Delivery},
 {Retry Remote Delivery} and {Poison} are monitored.

item:
 The name of the queue as defined in {winperf_msx_queues}.

examples:
 # Define queues to be monitored
 winperf_msx_queues = {
        "Active Remote Delivery"          : "10334",
        "Retry Remote Delivery"           : "10336",
        "Active Mailbox Delivery"         : "10338",
        "Retry Non-Smtp Delivery"         : "10344",
        "Items Queued For Delivery Total" : "10350",
 }

 # Default levels for all queues
 msx_queues_default_levels = (100, 200)

inventory:
 For each queue that is defined in {winperf_msx_queues} one check
 will be created if the agent outputs the matching performance counters.

