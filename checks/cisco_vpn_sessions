#!/usr/bin/env python3
# -*- coding: utf-8 -*-
# Copyright (C) 2019 tribe29 GmbH - License: GNU General Public License v2
# This file is part of Checkmk (https://checkmk.com). It is subject to the terms and
# conditions defined in the file COPYING, which is part of this source code package.


def _scan_cisco_vpn_sessions(_oid):
    raise NotImplementedError("Section according to new API implemented")


def check_cisco_vpn_sessions(item, params, parsed):
    yield check_levels(
        parsed[item],
        "active_sessions",
        params.get("active_sessions"),
        human_readable_func=int,
    )


check_info['cisco_vpn_sessions'] = {
    'inventory_function': discover(),
    'check_function': check_cisco_vpn_sessions,
    'service_description': '%s Sessions',
    'has_perfdata': True,
    'group': 'cisco_vpn_sessions',
    'snmp_scan_function': _scan_cisco_vpn_sessions,
    'snmp_info': (
        '.1.3.6.1.4.1.9.9.392.1.3',
        [
            '26',  # crasIPSecNumSessions
            '35',  # crasSVCNumSessions
            '38',  # crasWebvpnNumSessions
        ],
    ),
}
