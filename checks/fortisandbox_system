#!/usr/bin/python
# author: Oguzhan Cicek, OpenSource Security GmbH - oguzhan(at)os-s.de

# Example Input:
#[...]
#.1.3.6.1.4.1.12356.118.3.1.1.0 v2.52-build0340 (GA)
#.1.3.6.1.4.1.12356.118.3.1.2.0 2
#.1.3.6.1.4.1.12356.118.3.1.3.0 4
#.1.3.6.1.4.1.12356.118.3.1.4.0 260459760
#.1.3.6.1.4.1.12356.118.3.1.5.0 710698
#.1.3.6.1.4.1.12356.118.3.1.6.0 3754417
#.1.3.6.1.4.1.12356.118.3.1.7.0 2
#.1.3.6.1.4.1.12356.118.3.1.8.0 32908349
#.1.3.6.1.4.1.12356.118.3.2.1.0 5.2.50534
#.1.3.6.1.4.1.12356.118.3.2.2.0 2.4.20034
#.1.3.6.1.4.1.12356.118.3.2.3.0 3.2.279
#.1.3.6.1.4.1.12356.118.3.2.4.0 4.478
#.1.3.6.1.4.1.12356.118.3.2.5.0 14.613
#[...]

# Example GUI Output:
# OK	FortiSandbox System	Firmware version: v2.52-build0340 (GA)


def inventory_fortisandbox_system(info):
    if info:
        return [(None, None)]


def check_fortisandbox_system(item, params, info):
    state = 0
    statustext = "Firmware version: %s" % info[0][0][0]
    yield state, statustext


check_info['fortisandbox_system'] = {
    'inventory_function': inventory_fortisandbox_system,
    'check_function': check_fortisandbox_system,
    'has_perfdata': False,
    'service_description': "FortiSandbox System",
    'snmp_info': [(
        '.1.3.6.1.4.1.12356.118.3.1',
        [
            '1',  # fraSysVersion
        ])],
    'snmp_scan_function': lambda oid: '.1.3.6.1.4.1.12356.118.1.30006' in oid('.1.3.6.1.2.1.1.2.0').
                          lower(),
}
