#!/usr/bin/env python
# -*- encoding: utf-8; py-indent-offset: 4 -*-
# +------------------------------------------------------------------+
# |             ____ _               _        __  __ _  __           |
# |            / ___| |__   ___  ___| | __   |  \/  | |/ /           |
# |           | |   | '_ \ / _ \/ __| |/ /   | |\/| | ' /            |
# |           | |___| | | |  __/ (__|   <    | |  | | . \            |
# |            \____|_| |_|\___|\___|_|\_\___|_|  |_|_|\_\           |
# |                                                                  |
# | Copyright Mathias Kettner 2019             mk@mathias-kettner.de |
# +------------------------------------------------------------------+
#
# This file is part of Check_MK.
# The official homepage is at http://mathias-kettner.de/check_mk.
#
# check_mk is free software;  you can redistribute it and/or modify it
# under the  terms of the  GNU General Public License  as published by
# the Free Software Foundation in version 2.  check_mk is  distributed
# in the hope that it will be useful, but WITHOUT ANY WARRANTY;  with-
# out even the implied warranty of  MERCHANTABILITY  or  FITNESS FOR A
# PARTICULAR PURPOSE. See the  GNU General Public License for more de-
# tails. You should have  received  a copy of the  GNU  General Public
# License along with GNU Make; see the file  COPYING.  If  not,  write
# to the Free Software Foundation, Inc., 51 Franklin St,  Fifth Floor,
# Boston, MA 02110-1301 USA.
"""
Utilities for special agent vsphere
"""
import requests
import urllib3  # type: ignore


class ESXSession(requests.Session):
    """Encapsulates the Sessions with the ESX system"""
    ENVELOPE = ('<SOAP-ENV:Envelope'
                ' xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"'
                ' xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"'
                ' xmlns:ZSI="http://www.zolera.com/schemas/ZSI/"'
                ' xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/"'
                ' xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"'
                ' xmlns:xsd="http://www.w3.org/2001/XMLSchema"'
                ' xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">'
                '<SOAP-ENV:Header></SOAP-ENV:Header>'
                '<SOAP-ENV:Body xmlns:ns1="urn:vim25">%s</SOAP-ENV:Body>'
                '</SOAP-ENV:Envelope>')

    def __init__(self, address, port, no_cert_check=False):
        super(ESXSession, self).__init__()
        if no_cert_check:
            self.verify = False
            urllib3.disable_warnings(category=urllib3.exceptions.InsecureRequestWarning)

        self._post_url = "https://%s:%s/sdk" % (address, port)
        self.headers.update({
            "Content-Type": 'text/xml; charset="utf-8"',
            "SOAPAction": "urn:vim25/5.0",
            "User-Agent": "Checkmk special agent vsphere",
        })

    def postsoap(self, request):
        soapdata = ESXSession.ENVELOPE % request
        return super(ESXSession, self).post(self._post_url, data=soapdata)


class SoapTemplates(object):
    # yapf: disable
    SYSTEMINFO = (
        '<ns1:RetrieveServiceContent xsi:type="ns1:RetrieveServiceContentRequestType">'
        '  <ns1:_this type="ServiceInstance">ServiceInstance</ns1:_this>'
        '</ns1:RetrieveServiceContent>'
    )
    LOGIN = (
        '<ns1:Login xsi:type="ns1:LoginRequestType">'
        '  <ns1:_this type="SessionManager">%(sessionManager)s</ns1:_this>'
        '  <ns1:userName>%%(username)s</ns1:userName>'
        '  <ns1:password>%%(password)s</ns1:password>'
        '</ns1:Login>'
    )
    SYSTEMTIME = (
        '<ns1:CurrentTime xsi:type="ns1:CurrentTimeRequestType">'
        '  <ns1:_this type="ServiceInstance">ServiceInstance</ns1:_this>'
        '</ns1:CurrentTime>'
    )
    HOSTSYSTEMS = (
        '<ns1:RetrievePropertiesEx xsi:type="ns1:RetrievePropertiesExRequestType">'
        '  <ns1:_this type="PropertyCollector">%(propertyCollector)s</ns1:_this>'
        '  <ns1:specSet>'
        '    <ns1:propSet>'
        '      <ns1:type>HostSystem</ns1:type><ns1:pathSet>name</ns1:pathSet>'
        '    </ns1:propSet>'
        '    <ns1:objectSet>'
        '      <ns1:obj type="Folder">%(rootFolder)s</ns1:obj>'
        '      <ns1:skip>false</ns1:skip>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>visitFolders</ns1:name>'
        '        <ns1:type>Folder</ns1:type>'
        '        <ns1:path>childEntity</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>dcToHf</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>dcToVmf</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>crToH</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>crToRp</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>dcToDs</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>hToVm</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>rpToVm</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToVmf</ns1:name><ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>vmFolder</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToDs</ns1:name><ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>datastore</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToHf</ns1:name><ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>hostFolder</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>crToH</ns1:name>'
        '        <ns1:type>ComputeResource</ns1:type>'
        '        <ns1:path>host</ns1:path><ns1:skip>false</ns1:skip>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>crToRp</ns1:name><ns1:type>ComputeResource</ns1:type>'
        '        <ns1:path>resourcePool</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>rpToRp</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>rpToVm</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '         <ns1:name>rpToRp</ns1:name><ns1:type>ResourcePool</ns1:type>'
        '         <ns1:path>resourcePool</ns1:path><ns1:skip>false</ns1:skip>'
        '         <ns1:selectSet><ns1:name>rpToRp</ns1:name></ns1:selectSet>'
        '         <ns1:selectSet><ns1:name>rpToVm</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '         <ns1:name>hToVm</ns1:name><ns1:type>HostSystem</ns1:type>'
        '         <ns1:path>vm</ns1:path><ns1:skip>false</ns1:skip>'
        '         <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>rpToVm</ns1:name><ns1:type>ResourcePool</ns1:type>'
        '        <ns1:path>vm</ns1:path><ns1:skip>false</ns1:skip>'
        '      </ns1:selectSet>'
        '    </ns1:objectSet>'
        '  </ns1:specSet><ns1:options></ns1:options>'
        '</ns1:RetrievePropertiesEx>'
    )
    DATASTORES = (
        '<ns1:RetrievePropertiesEx xsi:type="ns1:RetrievePropertiesExRequestType">'
        '  <ns1:_this type="PropertyCollector">%(propertyCollector)s</ns1:_this>'
        '  <ns1:specSet>'
        '    <ns1:propSet><ns1:type>Datastore</ns1:type>'
        '      <ns1:pathSet>name</ns1:pathSet>'
        '      <ns1:pathSet>summary.freeSpace</ns1:pathSet>'
        '      <ns1:pathSet>summary.capacity</ns1:pathSet>'
        '      <ns1:pathSet>summary.uncommitted</ns1:pathSet>'
        '      <ns1:pathSet>summary.url</ns1:pathSet>'
        '      <ns1:pathSet>summary.accessible</ns1:pathSet>'
        '      <ns1:pathSet>summary.type</ns1:pathSet>'
        '      <ns1:pathSet>summary.maintenanceMode</ns1:pathSet>'
        '    </ns1:propSet>'
        '    <ns1:objectSet><ns1:obj type="Folder">%(rootFolder)s</ns1:obj>'
        '      <ns1:skip>false</ns1:skip>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>visitFolders</ns1:name>'
        '        <ns1:type>Folder</ns1:type>'
        '        <ns1:path>childEntity</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>dcToHf</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>dcToVmf</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>crToH</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>crToRp</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>dcToDs</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>hToVm</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>rpToVm</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToVmf</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>vmFolder</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToDs</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>datastore</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToHf</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>hostFolder</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>crToH</ns1:name>'
        '        <ns1:type>ComputeResource</ns1:type>'
        '        <ns1:path>host</ns1:path><ns1:skip>false</ns1:skip>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>crToRp</ns1:name><ns1:type>ComputeResource</ns1:type>'
        '        <ns1:path>resourcePool</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>rpToRp</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>rpToVm</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>rpToRp</ns1:name><ns1:type>ResourcePool</ns1:type>'
        '        <ns1:path>resourcePool</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>rpToRp</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>rpToVm</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>hToVm</ns1:name><ns1:type>HostSystem</ns1:type>'
        '        <ns1:path>vm</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>rpToVm</ns1:name><ns1:type>ResourcePool</ns1:type>'
        '        <ns1:path>vm</ns1:path><ns1:skip>false</ns1:skip>'
        '      </ns1:selectSet>'
        '    </ns1:objectSet>'
        '  </ns1:specSet><ns1:options></ns1:options>'
        '</ns1:RetrievePropertiesEx>'
    )
    LICENSESUSED = (
        '<ns1:RetrievePropertiesEx xsi:type="ns1:RetrievePropertiesExRequestType">'
        '  <ns1:_this type="PropertyCollector">%(propertyCollector)s</ns1:_this>'
        '  <ns1:specSet>'
        '    <ns1:propSet>'
        '      <ns1:type>LicenseManager</ns1:type>'
        '      <all>0</all>'
        '      <ns1:pathSet>licenses</ns1:pathSet>'
        '    </ns1:propSet>'
        '    <ns1:objectSet>'
        '      <ns1:obj type="LicenseManager">%(licenseManager)s</ns1:obj>'
        '    </ns1:objectSet>'
        '  </ns1:specSet>'
        '  <ns1:options/>'
        '</ns1:RetrievePropertiesEx>'
    )
    PERFCOUNTERSUMMARY = (
        '<ns1:QueryPerfProviderSummary xsi:type="ns1:QueryPerfProviderSummaryRequestType">'
        '  <ns1:_this type="PerformanceManager">%(perfManager)s</ns1:_this>'
        '  <ns1:entity type="HostSystem">%%(esxhost)s</ns1:entity>'
        '</ns1:QueryPerfProviderSummary>'
    )
    PERFCOUNTERSYNTAX = (
        '<ns1:QueryPerfCounter xsi:type="ns1:QueryPerfCounterRequestType">'
        '  <ns1:_this type="PerformanceManager">%(perfManager)s</ns1:_this>%%(counters)s'
        '</ns1:QueryPerfCounter>'
    )
    PERFCOUNTERAVAIL = (
        '<ns1:QueryAvailablePerfMetric xsi:type="ns1:QueryAvailablePerfMetricRequestType">'
        '  <ns1:_this type="PerformanceManager">%(perfManager)s</ns1:_this>'
        '  <ns1:entity type="HostSystem">%%(esxhost)s</ns1:entity>'
        '  <ns1:intervalId>20</ns1:intervalId>'
        '</ns1:QueryAvailablePerfMetric>'
    )
    PERFCOUNTERDATA = (
        '<ns1:QueryPerf xsi:type="ns1:QueryPerfRequestType">'
        '  <ns1:_this type="PerformanceManager">%(perfManager)s</ns1:_this>'
        '  <ns1:querySpec>'
        '    <ns1:entity type="HostSystem">%%(esxhost)s</ns1:entity>'
        '    <ns1:maxSample>%%(samples)s</ns1:maxSample>%%(counters)s'
        '    <ns1:intervalId>20</ns1:intervalId>'
        '  </ns1:querySpec>'
        '</ns1:QueryPerf>'
    )
    NETWORKSYSTEM = (
        '<ns1:RetrievePropertiesEx xsi:type="ns1:RetrievePropertiesExRequestType">'
        '  <ns1:_this type="PropertyCollector">%(propertyCollector)s</ns1:_this>'
        '  <ns1:specSet>'
        '    <ns1:propSet>'
        '      <ns1:type>HostNetworkSystem</ns1:type><all>0</all>'
        '      <ns1:pathSet>networkInfo</ns1:pathSet>'
        '    </ns1:propSet>'
        '    <ns1:objectSet>'
        '      <ns1:obj type="HostNetworkSystem">networkSystem</ns1:obj>'
        '    </ns1:objectSet>'
        '  </ns1:specSet><ns1:options></ns1:options>'
        '</ns1:RetrievePropertiesEx>'
    )
    ESXHOSTDETAILS = (
        '<ns1:RetrievePropertiesEx xsi:type="ns1:RetrievePropertiesExRequestType">'
        '  <ns1:_this type="PropertyCollector">%(propertyCollector)s</ns1:_this>'
        '  <ns1:specSet>'
        '    <ns1:propSet>'
        '      <ns1:type>HostSystem</ns1:type>'
        '      <ns1:pathSet>summary.quickStats.overallMemoryUsage</ns1:pathSet>'
        '      <ns1:pathSet>hardware.cpuPkg</ns1:pathSet>'
        '      <ns1:pathSet>hardware.pciDevice</ns1:pathSet>'
        '      <ns1:pathSet>runtime.powerState</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.overallCpuUsage</ns1:pathSet>'
        '      <ns1:pathSet>hardware.biosInfo.biosVersion</ns1:pathSet>'
        '      <ns1:pathSet>hardware.biosInfo.releaseDate</ns1:pathSet>'
        '      <ns1:pathSet>hardware.cpuInfo.hz</ns1:pathSet>'
        '      <ns1:pathSet>hardware.cpuInfo.numCpuThreads</ns1:pathSet>'
        '      <ns1:pathSet>hardware.cpuInfo.numCpuPackages</ns1:pathSet>'
        '      <ns1:pathSet>hardware.cpuInfo.numCpuCores</ns1:pathSet>'
        '      <ns1:pathSet>config.storageDevice.multipathInfo</ns1:pathSet>'
        '      <ns1:pathSet>hardware.systemInfo.model</ns1:pathSet>'
        '      <ns1:pathSet>hardware.systemInfo.uuid</ns1:pathSet>'
        '      <ns1:pathSet>hardware.systemInfo.otherIdentifyingInfo</ns1:pathSet>'
        '      <ns1:pathSet>hardware.systemInfo.vendor</ns1:pathSet>'
        '      <ns1:pathSet>name</ns1:pathSet>'
        '      <ns1:pathSet>overallStatus</ns1:pathSet>'
        '      <ns1:pathSet>runtime.healthSystemRuntime.systemHealthInfo.numericSensorInfo</ns1:pathSet>'
        '      <ns1:pathSet>runtime.healthSystemRuntime.hardwareStatusInfo.storageStatusInfo</ns1:pathSet>'
        '      <ns1:pathSet>runtime.healthSystemRuntime.hardwareStatusInfo.cpuStatusInfo</ns1:pathSet>'
        '      <ns1:pathSet>runtime.healthSystemRuntime.hardwareStatusInfo.memoryStatusInfo</ns1:pathSet>'
        '      <ns1:pathSet>runtime.inMaintenanceMode</ns1:pathSet>'
        '      <ns1:pathSet>hardware.memorySize</ns1:pathSet>'
        '    </ns1:propSet>'
        '    <ns1:objectSet>'
        '      <ns1:obj type="Folder">%(rootFolder)s</ns1:obj><ns1:skip>false</ns1:skip>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>visitFolders</ns1:name>'
        '        <ns1:type>Folder</ns1:type><ns1:path>childEntity</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>dcToHf</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>dcToVmf</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>crToH</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>crToRp</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>dcToDs</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>hToVm</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>rpToVm</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToVmf</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>vmFolder</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToDs</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>datastore</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToHf</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>hostFolder</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>crToH</ns1:name>'
        '        <ns1:type>ComputeResource</ns1:type>'
        '        <ns1:path>host</ns1:path><ns1:skip>false</ns1:skip>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>crToRp</ns1:name>'
        '        <ns1:type>ComputeResource</ns1:type>'
        '        <ns1:path>resourcePool</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>rpToRp</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>rpToVm</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>rpToRp</ns1:name>'
        '        <ns1:type>ResourcePool</ns1:type>'
        '        <ns1:path>resourcePool</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>rpToRp</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>rpToVm</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>hToVm</ns1:name>'
        '        <ns1:type>HostSystem</ns1:type>'
        '        <ns1:path>vm</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>rpToVm</ns1:name>'
        '        <ns1:type>ResourcePool</ns1:type>'
        '        <ns1:path>vm</ns1:path><ns1:skip>false</ns1:skip>'
        '      </ns1:selectSet>'
        '    </ns1:objectSet>'
        '  </ns1:specSet><ns1:options></ns1:options>'
        '</ns1:RetrievePropertiesEx>'
    )
    VMDETAILS = (
        '<ns1:RetrievePropertiesEx xsi:type="ns1:RetrievePropertiesExRequestType">'
        '  <ns1:_this type="PropertyCollector">%(propertyCollector)s</ns1:_this>'
        '  <ns1:specSet>'
        '    <ns1:propSet>'
        '      <ns1:type>VirtualMachine</ns1:type>'
        '      <ns1:pathSet>summary.quickStats.consumedOverheadMemory</ns1:pathSet>'
        '      <ns1:pathSet>config.hardware.numCPU</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.overallCpuDemand</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.distributedCpuEntitlement</ns1:pathSet>'
        '      <ns1:pathSet>runtime.host</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.distributedMemoryEntitlement</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.uptimeSeconds</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.sharedMemory</ns1:pathSet>'
        '      <ns1:pathSet>config.hardware.memoryMB</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.privateMemory</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.balloonedMemory</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.staticMemoryEntitlement</ns1:pathSet>'
        '      <ns1:pathSet>runtime.powerState</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.overallCpuUsage</ns1:pathSet>'
        '      <ns1:pathSet>config.hardware.numCoresPerSocket</ns1:pathSet>'
        '      <ns1:pathSet>config.hardware.device</ns1:pathSet>'
        '      <ns1:pathSet>config.template</ns1:pathSet>'
        '      <ns1:pathSet>guest.toolsVersion</ns1:pathSet>'
        '      <ns1:pathSet>guestHeartbeatStatus</ns1:pathSet>'
        '      <ns1:pathSet>name</ns1:pathSet>'
        '      <ns1:pathSet>summary.guest.hostName</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.compressedMemory</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.swappedMemory</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.guestMemoryUsage</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.staticCpuEntitlement</ns1:pathSet>'
        '      <ns1:pathSet>summary.quickStats.hostMemoryUsage</ns1:pathSet>'
        '      <ns1:pathSet>snapshot.rootSnapshotList</ns1:pathSet>'
        '      <ns1:pathSet>config.datastoreUrl</ns1:pathSet>'
        '      <ns1:pathSet>guest.toolsVersionStatus</ns1:pathSet>'
        '    </ns1:propSet>'
        '    <ns1:objectSet><ns1:obj type="Folder">%(rootFolder)s</ns1:obj><ns1:skip>false</ns1:skip>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>visitFolders</ns1:name>'
        '        <ns1:type>Folder</ns1:type>'
        '        <ns1:path>childEntity</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>dcToHf</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>dcToVmf</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>crToH</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>crToRp</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>dcToDs</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>hToVm</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>rpToVm</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToVmf</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>vmFolder</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToDs</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>datastore</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToHf</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>hostFolder</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>crToH</ns1:name>'
        '        <ns1:type>ComputeResource</ns1:type>'
        '        <ns1:path>host</ns1:path><ns1:skip>false</ns1:skip>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>crToRp</ns1:name>'
        '        <ns1:type>ComputeResource</ns1:type>'
        '        <ns1:path>resourcePool</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>rpToRp</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>rpToVm</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>rpToRp</ns1:name>'
        '        <ns1:type>ResourcePool</ns1:type>'
        '        <ns1:path>resourcePool</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>rpToRp</ns1:name></ns1:selectSet>'
        '        <ns1:selectSet><ns1:name>rpToVm</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>hToVm</ns1:name>'
        '        <ns1:type>HostSystem</ns1:type>'
        '        <ns1:path>vm</ns1:path><ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet><ns1:name>visitFolders</ns1:name></ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>rpToVm</ns1:name>'
        '        <ns1:type>ResourcePool</ns1:type>'
        '        <ns1:path>vm</ns1:path><ns1:skip>false</ns1:skip>'
        '      </ns1:selectSet>'
        '    </ns1:objectSet>'
        '  </ns1:specSet><ns1:options></ns1:options>'
        '</ns1:RetrievePropertiesEx>'
    )
    CONTINUETOKEN = (
        '<ns1:ContinueRetrievePropertiesEx xsi:type="ns1:ContinueRetrievePropertiesExRequestType">'
        '  <ns1:_this type="PropertyCollector">%(propertyCollector)s</ns1:_this>'
        '  <ns1:token>%%(token)s</ns1:token>'
        '</ns1:ContinueRetrievePropertiesEx>'
    )
    DATACENTERS = (
        '<ns1:RetrievePropertiesEx xsi:type="ns1:RetrievePropertiesExRequestType">'
        '  <ns1:_this type="PropertyCollector">%(propertyCollector)s</ns1:_this>'
        '  <ns1:specSet>'
        '    <ns1:propSet>'
        '      <ns1:type>Datacenter</ns1:type>'
        '      <ns1:pathSet>name</ns1:pathSet>'
        '    </ns1:propSet>'
        '    <ns1:objectSet>'
        '      <ns1:obj type="Folder">%(rootFolder)s</ns1:obj>'
        '      <ns1:skip>false</ns1:skip>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>visitFolders</ns1:name>'
        '        <ns1:type>Folder</ns1:type>'
        '        <ns1:path>childEntity</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>dcToHf</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>dcToVmf</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>crToH</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>crToRp</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>dcToDs</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>hToVm</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToVm</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToVmf</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>vmFolder</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToDs</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>datastore</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToHf</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>hostFolder</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>crToH</ns1:name>'
        '        <ns1:type>ComputeResource</ns1:type>'
        '        <ns1:path>host</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>crToRp</ns1:name>'
        '        <ns1:type>ComputeResource</ns1:type>'
        '        <ns1:path>resourcePool</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToRp</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToVm</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>rpToRp</ns1:name>'
        '        <ns1:type>ResourcePool</ns1:type>'
        '        <ns1:path>resourcePool</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToRp</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToVm</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>hToVm</ns1:name>'
        '        <ns1:type>HostSystem</ns1:type>'
        '        <ns1:path>vm</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>rpToVm</ns1:name>'
        '        <ns1:type>ResourcePool</ns1:type>'
        '        <ns1:path>vm</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '      </ns1:selectSet>'
        '    </ns1:objectSet>'
        '  </ns1:specSet>'
        '  <ns1:options/>'
        '</ns1:RetrievePropertiesEx>'
    )
    CLUSTERSOFDATACENTER = (
        '<ns1:RetrievePropertiesEx xsi:type="ns1:RetrievePropertiesExRequestType">'
        '  <ns1:_this type="PropertyCollector">propertyCollector</ns1:_this>'
        '  <ns1:specSet>'
        '    <ns1:propSet>'
        '      <ns1:type>ClusterComputeResource</ns1:type>'
        '      <ns1:pathSet>name</ns1:pathSet>'
        '    </ns1:propSet>'
        '    <ns1:objectSet>'
        '      <ns1:obj type="Datacenter">%%(datacenter)s</ns1:obj>'
        '      <ns1:skip>false</ns1:skip>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>visitFolders</ns1:name>'
        '        <ns1:type>Folder</ns1:type>'
        '        <ns1:path>childEntity</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>dcToHf</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>dcToVmf</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>crToH</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>crToRp</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>dcToDs</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>hToVm</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToVm</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToVmf</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>vmFolder</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToDs</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>datastore</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToHf</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>hostFolder</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>crToH</ns1:name>'
        '        <ns1:type>ComputeResource</ns1:type>'
        '        <ns1:path>host</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>crToRp</ns1:name>'
        '        <ns1:type>ComputeResource</ns1:type>'
        '        <ns1:path>resourcePool</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToRp</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToVm</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>rpToRp</ns1:name>'
        '        <ns1:type>ResourcePool</ns1:type>'
        '        <ns1:path>resourcePool</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToRp</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToVm</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>hToVm</ns1:name>'
        '        <ns1:type>HostSystem</ns1:type>'
        '        <ns1:path>vm</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>rpToVm</ns1:name>'
        '        <ns1:type>ResourcePool</ns1:type>'
        '        <ns1:path>vm</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '      </ns1:selectSet>'
        '    </ns1:objectSet>'
        '  </ns1:specSet>'
        '  <ns1:options/>'
        '</ns1:RetrievePropertiesEx>'
    )
    ESXHOSTSOFCLUSTER = (
        '<ns1:RetrievePropertiesEx xsi:type="ns1:RetrievePropertiesExRequestType">'
        '  <ns1:_this type="PropertyCollector">propertyCollector</ns1:_this>'
        '  <ns1:specSet>'
        '    <ns1:propSet>'
        '      <ns1:type>HostSystem</ns1:type>'
        '      <ns1:pathSet>name</ns1:pathSet>'
        '    </ns1:propSet>'
        '    <ns1:objectSet>'
        '      <ns1:obj type="ClusterComputeResource">%%(clustername)s</ns1:obj>'
        '      <ns1:skip>false</ns1:skip>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>visitFolders</ns1:name>'
        '        <ns1:type>Folder</ns1:type>'
        '        <ns1:path>childEntity</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>dcToHf</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>dcToVmf</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>crToH</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>crToRp</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>dcToDs</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>hToVm</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToVm</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToVmf</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>vmFolder</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToDs</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>datastore</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>dcToHf</ns1:name>'
        '        <ns1:type>Datacenter</ns1:type>'
        '        <ns1:path>hostFolder</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>crToH</ns1:name>'
        '        <ns1:type>ComputeResource</ns1:type>'
        '        <ns1:path>host</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>crToRp</ns1:name>'
        '        <ns1:type>ComputeResource</ns1:type>'
        '        <ns1:path>resourcePool</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToRp</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToVm</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>rpToRp</ns1:name>'
        '        <ns1:type>ResourcePool</ns1:type>'
        '        <ns1:path>resourcePool</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToRp</ns1:name>'
        '        </ns1:selectSet>'
        '        <ns1:selectSet>'
        '          <ns1:name>rpToVm</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>hToVm</ns1:name>'
        '        <ns1:type>HostSystem</ns1:type>'
        '        <ns1:path>vm</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '        <ns1:selectSet>'
        '          <ns1:name>visitFolders</ns1:name>'
        '        </ns1:selectSet>'
        '      </ns1:selectSet>'
        '      <ns1:selectSet xsi:type="ns1:TraversalSpec">'
        '        <ns1:name>rpToVm</ns1:name>'
        '        <ns1:type>ResourcePool</ns1:type>'
        '        <ns1:path>vm</ns1:path>'
        '        <ns1:skip>false</ns1:skip>'
        '      </ns1:selectSet>'
        '    </ns1:objectSet>'
        '  </ns1:specSet>'
        '  <ns1:options/>'
        '</ns1:RetrievePropertiesEx>'
    )
    # yapf: enable

    def __init__(self, system_fields):
        super(SoapTemplates, self).__init__()
        self.login = SoapTemplates.LOGIN % system_fields
        self.systemtime = SoapTemplates.SYSTEMTIME % system_fields
        self.hostsystems = SoapTemplates.HOSTSYSTEMS % system_fields
        self.datastores = SoapTemplates.DATASTORES % system_fields
        self.licensesused = SoapTemplates.LICENSESUSED % system_fields
        self.perfcountersummary = SoapTemplates.PERFCOUNTERSUMMARY % system_fields
        self.perfcountersyntax = SoapTemplates.PERFCOUNTERSYNTAX % system_fields
        self.perfcounteravail = SoapTemplates.PERFCOUNTERAVAIL % system_fields
        self.perfcounterdata = SoapTemplates.PERFCOUNTERDATA % system_fields
        self.networksystem = SoapTemplates.NETWORKSYSTEM % system_fields
        self.esxhostdetails = SoapTemplates.ESXHOSTDETAILS % system_fields
        self.vmdetails = SoapTemplates.VMDETAILS % system_fields
        self.continuetoken = SoapTemplates.CONTINUETOKEN % system_fields
        self.datacenters = SoapTemplates.DATACENTERS % system_fields
        self.clustersofdatacenter = SoapTemplates.CLUSTERSOFDATACENTER % system_fields
        self.esxhostsofcluster = SoapTemplates.ESXHOSTSOFCLUSTER % system_fields
