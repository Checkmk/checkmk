services:
    oracle-free:
        image: gvenzl/oracle-free:23.26.0
        ports:
        - "${ORACLE_PORT:-1521}:1521"
        environment:
            ORACLE_PASSWORD: oracle
        volumes:
            - oracle-free-volume:/opt/oracle/oradata
        healthcheck:
            test: [ "CMD", "healthcheck.sh" ]
            interval: 10s
            timeout: 5s
            retries: 10
            start_period: 5s
            start_interval: 5s

    oracle-xe:
        image: gvenzl/oracle-xe:11
        ports:
            - "${ORACLE_PORT:-1521}:1521"
        environment:
            ORACLE_PASSWORD: oracle
        volumes:
            - oracle-xe-volume:/opt/oracle/oradata
        healthcheck:
            test: [ "CMD", "healthcheck.sh" ]
            interval: 10s
            timeout: 5s
            retries: 10
            start_period: 5s
            start_interval: 5s

    oracle-12c:
        image: konnecteam/docker-oracle-12c:sequelize
        ports:
            - "${ORACLE_PORT:-1521}:1521"
        volumes:
            - oracle-12c:/u01/app/oracle
        healthcheck:
            test: [
                "CMD-SHELL",
                "grep -q 'XDB initialized' /u01/app/oracle/diag/rdbms/*/*/trace/alert*.log 2>/dev/null || exit 1",
            ]
            interval: 20s
            timeout: 5s
            retries: 10
            start_period: 60s

    oracle-19c:
        image: anvarmk/oracle-19c:latest
        ports:
            - "${ORACLE_PORT:-1521}:1521"
        environment:
            ORACLE_PWD: oracle
            ORACLE_SID: ORCLCDB
        volumes:
            - oracle-19c-volume:/opt/oracle/oradata
        healthcheck:
            test: [
                "CMD-SHELL",
                "echo 'SELECT 1 FROM DUAL; exit' | sqlplus -s -L system/oracle"
            ]
            interval: 10s
            timeout: 5s
            retries: 10
            start_period: 60s

volumes:
    oracle-free-volume:
    oracle-xe-volume:
    oracle-12c:
    oracle-19c-volume:
